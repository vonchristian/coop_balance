<div class="row">
  <div class="col-md-8">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title"> New Adjusting Entry Details </h3>
      </div>
      <div class="card-body">
        <%= simple_form_for @line_item, url: :accounting_module_entry_line_items do |f| %>
          <div class="row">
            <div class="col-md-5">
              <%= f.input :account_id, label: false, placeholder: "Account", collection: AccountingModule::Account.all.map{|a| [a.name, a.id] }, prompt: "Select Account" %>
            </div>
            <div class="col-md-3">
              <%= f.input :amount, label: false, placeholder: 'Amount', as: :currency  %>
            </div>
            <div class="col-md-2">
              <%= f.input :amount_type, label: false, collection: Vouchers::VoucherAmount.amount_types.keys.to_a.map{|a| [a.titleize, a] } %>
            </div>
            <div class="col-md-2">
              <%= f.input :employee_id, input_html: { value: current_user.id }, as: :hidden %>
              <%= f.submit "Add", class: "btn btn-outline-success" %>
            </div>
          </div>
          <br>
        <% end %>
        <hr>
        <div class="row">
          <div class="col-md-4">
            <b>ACCOUNT </b>
          </div>
          <div class="col-md-3">
            <span class="pull-right">
              <b>DEBIT</b>
            </span>
          </div>
          <div class="col-md-3">
            <span class="pull-right">
              <b>CREDIT</b>
            </span>
          </div>
        </div>
        <br>
        <% current_user.voucher_amounts.each do |amount| %>
          <div class="row">
            <div class="col-md-4">
              <%= amount.account_name %>
            </div>
            <div class="col-md-3">
              <% if amount.debit? %>
                <span class="pull-right">
                  <%= number_to_currency amount.amount %>
                </span>
              <% end %>
            </div>
            <div class="col-md-3">
              <% if amount.credit? %>
                <span class="pull-right">
                  <%= number_to_currency amount.amount %>
                </span>
              <% end %>
            </div>
            <div class="col-md-1">
              <%= link_to accounting_module_entry_line_item_path(amount), method: :delete do %>
                <span title="Remove" data-toggle="tooltip" class="fa fa-trash text-danger"></span>
              <% end %>
            </div>
          </div>
          <br>
        <% end %>
        <hr>
        <div class="row">
          <div class="col-md-4">
            <b>TOTAL </b>
          </div>
          <div class="col-md-3">
            <span class="pull-right">
              <b><%= number_to_currency current_user.voucher_amounts.debit.sum(&:amount) %></b>
            </span>
          </div>
          <div class="col-md-3">
            <span class="pull-right">
              <b><%= number_to_currency current_user.voucher_amounts.credit.sum(&:amount) %></b>
            </span>

          </div>
        </div>
        <br>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title"> Entry Details </h3>
      </div>
      <div class="card-body">
        <%=simple_form_for @entry, url: :accounting_module_entry_processings do |f| %>
          <%= f.input :date, as: :string, input_html: { class: "datepicker" } %>
          <%= f.input :description, as: :text %>
          <%= f.input :reference_number %>
          <%= f.input :payee_id, label: "Member", collection: Voucher.payees.map{|a| [a.name, a.id] } %>
          <%= f.input :employee_id, input_html: { value: current_user.id }, as: :hidden %>
            <% if current_user.voucher_amounts.present? %>
              <%= f.submit "Save Adjusting Entry", class: "btn btn-success pull-right" %>
            <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  $(document).ready(function() {
    $("#vouchers_voucher_amount_processing_account_id").select2({
      theme: "bootstrap"
    });
    $("#vouchers_voucher_amount_processing_amount_type").select2({
      theme: "bootstrap"
    });
     $("#vouchers_disbursement_processing_payee_id").select2({
      theme: "bootstrap"
    });
  });
</script>

