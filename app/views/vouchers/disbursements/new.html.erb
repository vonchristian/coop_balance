<div class="row">
  <div class="col-md-2">
  </div>
  <div class="col-md-8">
    <div class="card">
      <div class="card-header">

           <h4><center><%= @voucher.description %></center></h4>

            
      <div class="card-body">
          <table class="table table-hover">
              <thead>
                <tr>
                  <th>Description</th>
                  <th>Account</th>
                  <th>Debit</th>
                  <th>Credit</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <% @voucher.voucher_amounts.each do |voucher_amount| %>
                  <tr>
                    <td><%= voucher_amount.description %></td>
                    <td><%= voucher_amount.account_name %></td>
                    <td>
                      <% if voucher_amount.debit? %>
                        <%= number_to_currency voucher_amount.amount %>
                      <% end %>
                    </td>
                     <td>
                      <% if voucher_amount.credit? %>
                        <span class="pull-right"><%= number_to_currency voucher_amount.amount %></span>
                      <% end %>
                    </td>
                    <td>
                    </td>
                  </tr>
                <% end %>
                <% if @voucher.voucher_amounts.present? %>
                   <tr>
                    <td></td>
                    <td>TOTAL</td>
                    <td><b><%= number_to_currency @voucher.voucher_amounts.debit.sum(:amount) %></b></td>
                    <td><b class="pull-right"><%= number_to_currency @voucher.voucher_amounts.credit.sum(:amount) %></b></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                <% end %>
              </tbody>
            </table>


            <%= simple_form_for [@voucher, @disbursement], url: :voucher_disbursements do |f| %>
              <%= f.error_notification %>
              <%= f.input :voucher_id, input_html: { value: @voucher.id }, as: :hidden %>
              <%= f.input :voucherable_id, input_html: { value: @voucher.payee_id }, as: :hidden %>
              <%= f.input :amount, input_html: { value: @voucher.payable_amount }, as: :hidden %>
              <%= f.input :description, required: true, input_html: { value: @voucher.description } %>
              <%= f.input :reference_number %>
              <%= f.input :date, label: "Date Disbursed", as: :string, input_html: { class: "datepicker" } %>
              <%= f.input :recorder_id, input_html: { value: current_user.id }, as: :hidden %>
              <%= f.input :total_amount, input_html: { value: @voucher.voucher_amounts.where(account_id: User.cash_on_hand_accounts).sum(:amount) }, as: :hidden %>
              <div class="box-footer">
                <%= link_to 'Back', voucher_path(@voucher), class: "btn btn-default float-left" %>
                <%= f.submit "Disburse Voucher", class: "btn btn-primary float-right" %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
