<div class="row">
  <div class="col-md-9 col-md-offset-1">
    <div class="card">
      <div class="card-header">

           <h4><center><%= image_tag(@voucher.payee.avatar, style: 'width:60px;height:60px;', class: 'media-object img-circle') %></center></h4>

            <h3 class="card-title"><center><%= @voucher.payee.try(:name) %></center></h3>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-10 col-md-offset-1">
          <table class="table table-hover">
              <thead>
                <tr>
                  <th>Description</th>
                  <th>Account</th>
                  <th>Debit</th>
                  <th>Credit</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <% @voucher.voucher_amounts.each do |voucher_amount| %>
                  <tr>
                    <td><%= voucher_amount.description %></td>
                    <td><%= voucher_amount.account_name %></td>
                    <td>
                      <% if voucher_amount.debit? %>
                        <%= number_to_currency voucher_amount.amount %>
                      <% end %>
                    </td>
                     <td>
                      <% if voucher_amount.credit? %>
                        <span class="pull-right"><%= number_to_currency voucher_amount.amount %></span>
                      <% end %>
                    </td>
                    <td>
                    </td>
                  </tr>
                <% end %>
                <% if @voucher.voucher_amounts.present? %>
                   <tr>
                    <td></td>
                    <td>TOTAL</td>
                    <td><b><%= number_to_currency @voucher.voucher_amounts.debit.sum(:amount) %></b></td>
                    <td><b class="pull-right"><%= number_to_currency @voucher.voucher_amounts.credit.sum(:amount) %></b></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                <% end %>
              </tbody>
            </table>

            <div class="row">
              <div class="col-md-6">
                <h4>Amount to be Disbursed </h4>
              </div>
              <div class="col-md-6">
                <h4>
                  <span class="pull-right">
                    <%= number_to_currency @voucher.voucher_amounts.where(account_id: User.cash_on_hand_accounts).sum(:amount) %>
                  </span>
                </h4>
              </div>
            </div>
            <hr />
            <%= simple_form_for [@voucher, @disbursement], url: :voucher_disbursements do |f| %>
              <%= f.error_notification %>
              <%= f.input :voucher_id, input_html: { value: @voucher.id }, as: :hidden %>
              <%= f.input :voucherable_id, input_html: { value: @voucher.payee_id }, as: :hidden %>
              <%= f.input :amount, input_html: { value: @voucher.payable_amount }, as: :hidden %>
              <%= f.input :description, required: true, input_html: { value: @voucher.description } %>
              <%= f.input :reference_number %>
              <%= f.input :date, label: "Date Disbursed", as: :string, input_html: { class: "datepicker" } %>
              <%= f.input :recorder_id, input_html: { value: current_user.id }, as: :hidden %>
              <%= f.input :total_amount, input_html: { value: @voucher.voucher_amounts.where(account_id: User.cash_on_hand_accounts).sum(:amount) }, as: :hidden %>
              <div class="box-footer">
                <%= link_to 'Back', voucher_path(@voucher), class: "btn btn-default pull-left" %>
                <%= f.submit "Disburse Voucher", class: "btn btn-primary pull-right" %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

