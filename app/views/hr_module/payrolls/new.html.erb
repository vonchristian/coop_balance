<div class="row">
  <div class="col-md-6 col-md-offset-3">
    <div class="box box-solid">
      <div class="box-header bg-gray">
        <div class="row">
          <div class="col-md-3">
            <center><%=image_tag(@employee.avatar.url(:medium), class: "img-circle", height: 80, width: 80) %></center>
          </div>
          <div class="col-md-8">
            <br>
            <h3 class="box-title"><%= @employee.first_and_last_name.try(:upcase) %></h3><br>
            <small><%= @employee.role.titleize %></small>
          </div>
        </div>
      </div>

      <div class="box-body">
        <div class="row">
          <div class="col-md-6 col-md-offset-1">
            SALARY 
          </div>
          <div class="col-md-4">
            <%=number_to_currency @employee.salary_grade_amount, class: "pull-right" %>
          </div>
        </div>
        <br>
        <p class="text-red">DEDUCTIONS </p>
        <div class="row">
          <div class="col-md-6 col-md-offset-1">
            A/R General Merchandise
          </div>
          <div class="col-md-3">
            <%=number_to_currency AccountingModule::Account.find_by(name: "Accounts Receivables Trade - Current (General Merchandise)").balance(commercial_document_id: @employee.id) %>
          </div>
        </div>
        <hr>
        <p class="text-purple"> CONTRIBUTIONS </p>
        <% @employee.contributions.each do |contribution| %>
          <div class="row">
            <div class="col-md-6 col-md-offset-1">
              <%= contribution.name %>
            </div>
            <div class="col-md-3">
              <span class="pull-right"><%= number_to_currency contribution.amount %></span>
            </div>
          </div>
          <br>
        <% end %>
        <% @employee.voucher_amounts.each do |voucher_amount| %>
          <div class="row">
            <div class="col-md-6 col-md-offset-1">
              <%= voucher_amount.account.try(:name) %>
            </div>
            <div class="col-md-3">
              <span class="pull-right"> 
                <%= number_to_currency voucher_amount.amount %>
              </span>
            </div>
            <div class="col-md-1">
              <%=link_to employee_amount_path(id: voucher_amount.id), method: :delete do %>
                <span class="text-danger"><i class="fa fa-trash"></i> </span>
              <% end %>
            </div>
          </div>
          <br />
        <% end %>
        <div class="row">
          <div class="col-md-6 col-md-offset-1">
            <b>TOTAL </b>
          </div>
          <div class="col-md-3">
            <b class="pull-right"><%=number_to_currency @employee.voucher_amounts.sum(&:amount) %></b>
          </div>
        </div>
        <hr />
         <%= simple_form_for @amount, url: :hr_module_employee_payroll_amounts do |f| %>
          <div class="row">
            <div class="col-md-2">
              <%= f.input :amount, label: false, placeholder: "Amount", as: :string %>
            </div>
            <div class="col-md-4">
              <%= f.input :account_id, label: false, prompt: "Select Account", collection: AccountingModule::Account.all.map{|a| [a.name, a.id] }  %>
            </div>
            <div class="col-md-4">
              <%= f.input :description, label: false, placeholder: "Description" %>
            </div>
            <div class="col-md-1">
              <%= f.submit "Add", class: "btn btn-primary btn-sm" %>
            </div>
          </div>
        <% end %>
        <% if @employee.voucher_amounts.present? %>
          <div class="row">
            <div class="col-md-10 col-md-offset-1">
              <p class="text-muted">
                VOUCHER DETAILS
              </p>
              <%= simple_form_for @voucher, url: :employee_vouchers do |f| %>
                <%= f.input :date, as: :string, input_html: { class: "datepicker" } %>
                <%= f.input :description, as: :trix_editor %>
                <%= f.input :payee_id, input_html: { value: @employee.id }, as: :hidden %>
                <%= f.input :payee_type, input_html: { value: @employee.class }, as: :hidden %>
                  <%= f.input :voucherable_id, input_html: { value: @employee.id }, as: :hidden %>
                <%= f.input :voucherable_type, input_html: { value: @employee.class }, as: :hidden %>
                <div class="box-footer">
                  <%= f.submit "Create Voucher", class: "btn btn-primary btn-flat pull-right" %>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  $(document).ready(function() {
    $("#voucher_amount_account_id").select2({
      theme: "bootstrap"
    });
  });
</script>