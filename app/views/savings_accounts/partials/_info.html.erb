<% breadcrumb :savings_account_details, @savings_account %>
<div class="card-body">
  <div class="row">
    <div class="col-md-6">
      <div class="row justify-content-end">
        <div class="col-md-7 col-sm-6 col-auto">
          <small>CURRENT BALANCE</small>
          <h2 class="number"><%= number_to_currency @savings_account.balance %></h2>
          <small class="badge bg-danger"><%= @savings_account.number_of_days_inactive %> DAYS INACTIVE</small>


        </div>
        <div class="col-md-4 col-sm-6 col-auto">
          <small>LAST TRANSACTION</small><br>
          <i class="fa fa-calendar"></i> &nbsp; <%= @savings_account.last_transaction_date.strftime("%B %e, %Y") %>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <%=link_to 'Statement of Account', savings_account_path(@savings_account, format: 'pdf') %>
    </div>
  </div>
</div>
<hr class="no-margin">
<div class="card-body">
  <% if @savings_account.closed? %>
    <div class="corner-ribbon top-left red">Closed</div>
  <% end %>
    <% month_dates = [] %>
    <% ((Date.current - 6.months)..Date.current).each do |date| %>
      <% month_dates << date.end_of_month %>
    <% end %>
    <% monthly_balances_data = [] %>
    <% month_dates.uniq.each do |month| %>
      <% monthly_balances_data << { month.strftime("%B") => @savings_account.balance(to_date: month.end_of_month) } %>
    <% end %>
    <%= area_chart (Hash[*monthly_balances_data.collect{|h| h.to_a}.flatten].delete_if{|k,v| v.blank?}),messages: {empty: "No data"}, thousands: ",", curve: false %>
</div>
