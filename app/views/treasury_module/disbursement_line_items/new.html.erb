<div class="row">
  <div class="col-md-8">
    <div class="box box-default">
      <div class="box-header">
        <h3 class="box-title"> Disbursement Details </h3>
      </div>
      <div class="box-body">
        <%= simple_form_for @disbursement_line_item, url: :treasury_module_disbursement_line_items do |f| %>
          <div class="row">
            <div class="col-md-5">
              <%= f.input :account_id, label: false, placeholder: "Account", collection: AccountingModule::Account.all.map{|a| [a.name, a.id] }, prompt: "Select Account" %>
            </div>
            <div class="col-md-3">
              <%= f.input :amount, label: false, placeholder: 'Amount'  %>
            </div>
            <div class="col-md-2">
              <%= f.input :amount_type, label: false, collection: Vouchers::VoucherAmount.amount_types.keys.to_a.map{|a| [a.titleize, a] } %>
            </div>
            <div class="col-md-2">
              <%= f.input :employee_id, input_html: { value: current_user.id }, as: :hidden %>
              <%= f.submit "Add", class: "btn btn-default" %>
            </div>
          </div>
          <br>
        <% end %>
        <hr>
        <div class="row">
          <div class="col-md-6">
            <b>ACCOUNT </b>
          </div>
          <div class="col-md-3">
            <b>DEBIT</b>
          </div>
          <div class="col-md-3">
            <b>CREDIT</b>
          </div>
        </div>
        <br>
        <% current_user.voucher_amounts.each do |amount| %>
          <div class="row">
            <div class="col-md-6">
              <%= amount.account_name %>
            </div>
            <div class="col-md-3">
              <% if amount.debit? %>
                <%= number_to_currency amount.amount %>
              <% end %>
            </div>
            <div class="col-md-3">
              <% if amount.credit? %>
                <%= number_to_currency amount.amount %>
              <% end %>
            </div>
          </div>
          <br>
        <% end %>
        <hr>
        <div class="row">
          <div class="col-md-6">
            <b>TOTAL </b>
          </div>
          <div class="col-md-3">
            <b><%= number_to_currency current_user.voucher_amounts.debit.sum(&:amount) %></b>
          </div>
          <div class="col-md-3">
            <b><%= number_to_currency current_user.voucher_amounts.credit.sum(&:amount) %></b>
          </div>
        </div>
        <br>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="box box-default">
      <div class="box-header">
        <h3 class="box-title"> Payee Details </h3>
      </div>
      <div class="box-body">
        <%=simple_form_for @disbursement, url: :treasury_module_disbursement_processings do |f| %>
          <%= f.input :date, as: :string, input_html: { class: "datepicker" } %>
          <%= f.input :description, as: :text %>
          <%= f.input :reference_number %>
          <%= f.input :payee_id, label: "Payee", collection: Voucher.payees.map{|a| [a.name, a.id] } %>
          <%= f.input :employee_id, input_html: { value: current_user.id }, as: :hidden %>
          <div class="box-footer">
            <% if current_user.voucher_amounts.present? %>
              <%= f.submit "Disburse Amount", class: "btn btn-primary pull-right" %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  $(document).ready(function() {
    $("#disbursement_line_item_processing_account_id").select2({
      theme: "bootstrap"
    });
    $("#disbursement_line_item_processing_amount_type").select2({
      theme: "bootstrap"
    });
     $("#disbursement_processing_payee_id").select2({
      theme: "bootstrap"
    });
  });
</script>

